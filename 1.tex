\section{Problèmes d'optimisation linéaire}

Soit le problème

$$
\begin{array}{ll}
  \mini   &  f(x_1, \ldots, x_n) \\
  \mbox{sous la contrainte} &  (x_1, \ldots, x_n)  \in \Omega
\end{array}
$$


Les scalaires $x_1, \ldots, x_n \in \R$ sont les \emph{variables de décision}, $f$  est la \emph{fonction objectif}
(on parle volontier de \emph{fonction coût} pour un problème de minimisation et de \emph{fonction profit} pour un problème de maximisation), et
$\Omega$ est le \emph{domaine admissible}. Un élément de $\R^n$ est une \emph{solution}, c'est une \emph{solution admissible}   si
$x
\in \Omega$. Si la solution admissible
$\xopt$ est telle que
$f(\xopt) \leq f(x)$ pour toute autre solution admissible
$x$,  la solution $\xopt$ est \emph{optimale}. L'\emph{objectif optimal}   est alors donné par
$f(\xopt)$. Lorsqu'il existe, le coût optimal est unique. Par contre, il peut y avoir de nombreuses solutions optimales et l'ensemble des solutions
optimales peut être non borné. Si pour tout
$K$ il existe une solution admissible $x \in \Omega$ telle que $f(x) \leq K$, le coût est dit \emph{non borné}. On
dit aussi que le  coût est \emph{égal à
$-\infty$}.\\

\newpage



\begin{enumerate}


  \item Un étudiant dispose de 100 heures de travail pour étudier les examens A, B et C. Il pense gagner par heure de travail et par
    cours: 1/5 de points pour le cours A, 2/5 de points pour le cours B et 3/5 pour le cours C. Chaque examen est coté sur 20. Les
    exercices de ces cours comptent pour la moitié de la cote finale. Ses résultats pour les exercices lui ont été communiqués. Il a
    obtenu 12/20 pour A, 12.5/20 pour B et 13.4/20 pour C.  L'étudiant doit obtenir au minimum une cote globale de 10/20 pour chaque cours. Tous
    les cours ont la même pondération et l'étudiant désire obtenir la  moyenne la plus élevée possible.  Formulez ce problème comme un problème d'optimisation
    linéaire (solution lors d'une séance ultérieure).
    \begin{solution}
      Soient $x_{A}$, $x_{B}$ et $x_{C}$ le nombre d'heures consacrées aux cours $A, B$ et $C$ respectivement.
      Introduisons le vecteur
      \(
      x =
      \begin{pmatrix}
        x_A & x_B & x_C
      \end{pmatrix}^T
      \)
      et la notation $x \geq 0$ signifiant que toutes les composantes du vecteur $x$ sont positives.

      On peut simplifier l'objectif $(6+x_A/10 + 6.25+x_B/5 + 6.7+3x_C/10)/3$
      en le multipliant par 30 et en retirant le terme constant.
      La valeur optimale de l'objectif changera et ne sera plus la moyenne de l'étudiant
      mais la valeur optimale de $x$ ne changera pas.

      Ça nous donne le problème d'optimisation suivant:
      \[
      \begin{array}{llcr}
        \maxi & x_A + 2x_B + 3x_C\\
        & 6 + \frac{x_A}{10} & \geq & 10\\
        & 6.25 + \frac{x_B}{5} & \geq & 10\\
        & 6.7 + \frac{3x_C}{10} & \geq & 10\\
        & \frac{x_A}{5} & \leq & 20\\
        & \frac{2x_B}{5} & \leq & 20\\
        & \frac{3x_C}{5} & \leq & 20\\
        & x_A + x_B + x_C & \leq & 100\\
        & x & \geq & 0
      \end{array}
      \]
    \end{solution}


  \item Une société produit des biens A, B et C. La production des biens nécessite l'utilisation de 4 machines. Les temps de production
    et les profits générés sont repris dans le tableau suivant\\

    $
    \begin{array}{l|llll|l}
      & 1 & 2 & 3 & 4 & \mbox{profit}\\
      \hline
      A & 1 & 3 & 1 & 2 & 6\\
      B & 6 & 1 & 3 & 3 & 6\\
      C & 3 & 3 & 2 & 4 & 6
    \end{array}
    $
    \\


    Les temps de production disponibles sur les machines 1, 2, 3 et 4  sont de 84, 42, 21 et 42 et la société cherche à  maximiser son
    profit. Formulez ce problème comme un problème d'optimisation linéaire.

    \begin{solution}
      Soient $x_{A}$, $x_{B}$ et $x_{C}$
      la quantité de biens $A, B$ et $C$ produite.
      Introduisons le vecteur
      \(
      x =
      \begin{pmatrix}
        x_A & x_B & x_C
      \end{pmatrix}^T
      \)
      et la notation $x \geq 0$ signifiant que toutes les composantes du vecteur $x$ sont positives.

      On peut modéliser le problème d'optimisation par le problème d'optimisation linéaire suivant:
      \[ \max 6(x_{A} + x_{B} + x_{C}) \]
      sous les contraintes
      \begin{align*}
        \begin{pmatrix}
          1 & 6 & 3\\
          3 & 1 & 3\\
          1 & 3 & 2\\
          2 & 3 & 4
        \end{pmatrix}
        \begin{pmatrix}
          x_{A}\\
          x_{B}\\
          x_{C}
        \end{pmatrix}
        & \leq
        \begin{pmatrix}
          84\\
          42\\
          21\\
          42
        \end{pmatrix}\\
        x & \geq 0.
      \end{align*}
    \end{solution}


  \item Il y a en Belgique $I$ communes, $J$ écoles et $G$ niveaux
    d'enseignement. L'école $j$ possède  une capacité d'accueil de $c_{jg}$
    écoliers pour le niveau $g$. Dans la commune $i$, le nombre d'écoliers devant
    suivre le niveau d'enseignement $g$ est égal à $s_{ig}$. Enfin, la distance de
    l'école $j$ à la commune $i$ est égale à $d_{ij}$. On demande d'affecter les écoliers dans les écoles de façon à minimiser la
    distance totale parcourue par l'ensemble des écoliers. Formulez ce problème comme un problème d'optimisation linéaire.


    \begin{solution}
      Soit $x_{ijg}$ le nombre d'étudiants d'une commune $i$ allant à l'école $j$ de niveau $g$.
      Introduisons la notation $x \geq 0$ signifiant que toutes les composantes du vecteur $x$ sont positives.

      \[ \min \sum_{i=1}^I \sum_{j=1}^J d_{ij} \sum_{g=1}^G x_{ijg} \]
      sous les contraintes
      \begin{align*}
        \sum_{i=1}^I x_{ijg} & \leq c_{jg} & \forall j, g\\
        \sum_{j=1}^J x_{ijg} & = s_{ig} & \forall i, g\\
        x & \geq 0.
      \end{align*}
    \end{solution}


  \item Résolvez géométriquement le problème suivant

    $
    \begin{array}{lrcl}
      \maxi & 12 x_1+16 x_2\\
      & x_1 + x_2 & \leq & 150\\
      & 1/2 x_1 + 3x_2 & \leq & 200\\
      & x_1, x_2 & \geq & 0
    \end{array}
    $

    La fonction objectif change et devient $17 x_1+16 x_2$. Que se passe-t-il? L'ensemble des solutions optimales est-il toujours fini?
    \begin{solution}
      Pour résoudre l'exercice, on prend la droite $12x_1 + 16x_2 = z$.
      On part de $z = \infty$ et on diminue $z$ jusqu'à intercepter l'ensemble
      amissible.
      On constate alors que le sommet est à l'intersection des droites
      \begin{align*}
        x_{1} + x_{2} & = 150\\
        \frac{1}{2}x_{1} + 3x_{2} & = 200.
      \end{align*}
      La solution optimale est $\xopt = (100,50)^{T}$.
      La solution optimale est unique parce que la droite n'intersecte
      qu'un point du domaine lorsque sa valeur est maximale.

      Avec $17 x_1 + 16x_2$, la solution optimale est à l'intersection de
      \begin{align*}
        x_{1} + x_{2} & = 150\\
        x_2 = 0.
      \end{align*}
      Elle vaut donc $\xopt = (150,0)$ et est à nouveau unique.
      \begin{center}
        \begin{tikzpicture}[scale=0.02]
        % Axis
        \draw[axis] (0,0) -- (200,0) node[right=\nudge cm] {\(x_1\)};
        \draw[axis] (0,0) -- (0,100) node[above=\nudge cm] {\(x_2\)};
        \begin{scope}
          % Avoid going too far
          \clip (-\nudge,-\nudge) rectangle (200+\nudge,100+\nudge);
          \draw[line] (0,200/3) -- (400,0) coordinate (ineq1);
          \draw[line] (0,150) -- (150,0) coordinate (ineq2);
          \draw[obj] (150,0) -- (200/12,200);
          \draw[obj] (500/3,0) -- (0,125);
          \begin{scope}
          %Clip sélectionne ce qu'il y a dans le polygone dessiné.
            \clip (0,200/3) |- (150,0) -- (100,50);
            \fill[hash] (0,0) rectangle (200,100);
            %\draw[dashed,line] (0,1) -- (2,2) -- (3,1) -- (2,0);
          % (4,4) to be enough, anyway clip restrict us to the good part
          \end{scope}
        \end{scope}
        %\node[above right] at (ineq1) {\(\mathllap{-}3 x_1 + 4 x_2 = 4\)};
        %\node[above left] at (ineq1) {\(x_1 + x_2 = 1\)};
        %\node[above right] at (ineq2) {\(x_1 + 2 x_2 = 3\)};
        \foreach \coord/\adj in {
          {(150,0)}/below,
          {(100,50)}/above right,
          {(0,200/3)}/left%
        } {
          \fill \coord circle (100pt) node[\adj] {$\coord$};
        }
        \end{tikzpicture}
      \end{center}
    \end{solution}


  \item Soit le problème d'optimisation linéaire

    $
    \begin{array}{lrcr}
      \mini & c_1 x_1 + c_2 x_2 + c_3 x_3\\
      & x_1 + x_2 & \geq & 1\\
      & x_1 + 2x_2 & \leq & 3\\
      & x_1, x_2, x_3 & \geq & 0
    \end{array}
    $

    Représentez l'ensemble des solutions admissibles. Trouvez le coût optimal et les solutions  optimales pour les
    valeurs suivantes de $c$: $c=(-1, 0, 1)$,
    $c=(0, 1, 0)$ et
    $c=(0, 0, -1)$.

    \begin{solution}
      \begin{enumerate}
        \item $c = (-1,0,1)$.
          $$ \min -x_{1} + x_{3} $$
          La solution optimale est $\xopt = (3,0,0)^{T}$
          avec un coût de $-3$.
        \item $c = (0,1,0)$.
          $$ \min x_{2} $$
          La solution optimale est  $\xopt = (x_1,0,x_3)^{T}$
          avec $1\le x_1 \le 3$ et $x_3 \geq 0$.
          Le coût est de 0.
        \item $c = (0,0,-1)$
          $$ \min -x_{3} $$
          La solution optimale est $\xopt = (x_{1},x_{2},\infty)^{T}$
          avec $x_{1}$, $x_{2}$ des variables positives telles que
          $x_{1} + x_{2} \geq 1$ et $x_{1} + 2x_{2} \le 3$.
          Le coût est non borné, c'est $-\infty$.
      \end{enumerate}
      \begin{center}
        \begin{tikzpicture}
        % Axis
        \draw[axis] (0,0) -- (3,0) node[right=\nudge cm] {\(x_1\)};
        \draw[axis] (0,0) -- (0,1.5) node[above=\nudge cm] {\(x_2\)};
        \begin{scope}
          % Avoid going too far
          \clip (-\nudge,-\nudge) rectangle (3+\nudge,1.5+\nudge);
          \draw[line] (-1,2) -- (2,-1) coordinate (ineq1);
          \draw[line] (-1,2) -- (4,-0.5) coordinate (ineq2);
          \begin{scope}
          %Clip sélectionne ce qu'il y a dans le polygone dessiné.
            \clip (0,1.5) -- (3,0) -- (1,0) -- (0,1);
            \fill[hash] (0,0) rectangle (3,1.5);
            %\draw[dashed,line] (0,1) -- (2,2) -- (3,1) -- (2,0);
          % (4,4) to be enough, anyway clip restrict us to the good part
          \end{scope}
        \end{scope}
        %\node[above right] at (ineq1) {\(\mathllap{-}3 x_1 + 4 x_2 = 4\)};
        \node[above left] at (ineq1) {\(x_1 + x_2 = 1\)};
        \node[above right] at (ineq2) {\(x_1 + 2 x_2 = 3\)};
        \foreach \coord/\adj in {
          {(3,0)}/above,% or right, left, below left, above right
          {(0,1.5)}/right% or right, left, below left, above right
        } {
          \fill \coord circle (2pt) node[\adj] {$\coord$};
        }
        \end{tikzpicture}
      \end{center}
    \end{solution}


  \item  Trouvez, si possible, des problèmes d'optimisation linéaire pour lesquels le problème

    \begin{enumerate}
      \item Poss\`ede un co\^ut optimal fini et exactement une solution optimale.
      \item Poss\`ede exactement deux solutions optimales.
      \item Possède un coût optimal infini.
      \item Possède un coût optimal fini et un ensemble de solutions optimales infini et borné.
      \item Possède un coût optimal fini et un ensemble de solutions  optimales non-borné.

    \end{enumerate}

    \begin{solution}
      \begin{enumerate}
        \item
          $$ \min x_1$$
          sous la contrainte
          $$ x_{1} \geq 0$$
        \item C'est impossible car l'ensemble des solutions optimales
          est un ensemble convexe donc s'il y a deux solutions optimales
          $\xopt$ et $y^*$. On a aussi une infinité de solution donnée par
          \[ \lambda x + (1-\lambda) y \]
          où $0 < \lambda < 1$.
          Il ne peut donc pas y en avoir exactement 2.
        \item
          $$ \max x_1 $$
          sous la contrainte
          $$ x_1 \geq 0 $$
        \item
          $$ \min x_{1}$$
          sous les contraintes
          $$ x_{2} \leq 1$$
          $$ x_{1}, x_{2} \geq 0$$
        \item
          $$ \min x_1 $$
          sous la contrainte
          $$ x_1 \geq 0$$
      \end{enumerate}
    \end{solution}

  \item Soit le problème d'optimisation linéaire

    $
    \begin{array}{ll}
      \mini &  c^T x \\
      \mbox{ }
      & A x \geq b
    \end{array}
    $

    Comment évolue l'objectif optimum si on ajoute une contrainte?

    \begin{solution}
      Il y a trois cas possibles.
      \begin{itemize}
        \item Soit l'objectif optimum augmente,
          c'est la nouvelle contrainte diminue l'ensemble admissible et la solution optimale était dans la partie de l'ensemble admissible qu'on a retiré;
        \item Soit il ne change pas, c'est le cas si la nouvelle contrainte ne modifie pas l'ensemble admissible ou si il reste une solution admissible avec le même coût optimal une fois la contrainte appliquée;
        \item Soit cette contrainte est telle que l'ensemble admissible
          devient vide.
          Dans ce cas, il n'y a plus de solution optimale
          et le coût n'est plus défini.
      \end{itemize}
      L'objectif optimum ne peut diminuer car on ne fait
      que restreindre l'ensemble admissible;
    \end{solution}

  \item Un sous-ensemble $V$ de $\R^n$ est convexe si $x, y \in V \Rightarrow \lambda x + (1-\lambda) y \in V$ pour tout $0 < \lambda <1$. Démontrez que
    l'ensemble des solutions optimales d'un problème d'optimisation linéaire est un ensemble convexe.

    \begin{solution}
      On sait que tout problème peut s'écrire sous forme géométrique.
      Considérons donc cette forme.
      Soient $\xopt, y^{*}$ des solutions optimales du problème
      $$ \min c^{T}x$$
      $$ Ax \geq b$$
      Prouvons que $\lambda \xopt + (1-\lambda)y^{*}$ est aussi une solution
      optimal.
      C'est à dire que
      \[ c^{T}(\lambda \xopt + (1-\lambda)y^{*}) = c^{T}\xopt \]
      et que
      \[ A(\lambda \xopt + (1-\lambda)y^{*}) \geq b. \]
      \begin{proof}
        Comme $\xopt$ et $y^*$ sont solutions,
        on a $c^T\xopt = c^Ty^*$ et donc
        \begin{align*}
          c^{T}(\lambda \xopt + (1-\lambda)y^{*})
          & = \lambda c^{T}\xopt  + (1-\lambda)c^{T}y^{*}\\
          & = \lambda c^{T}\xopt  + (1-\lambda)c^{T}\xopt\\
          & = c^{T}\xopt.
        \end{align*}
        Ensuite,
        comme $A\xopt \geq b$, $Ay^* \geq b$ et $\lambda, 1-\lambda \geq 0$,
        on a
        \begin{align*}
          A(\lambda \xopt + (1-\lambda)y^{*})
          & = \lambda A\xopt + (1-\lambda)Ay^{*}\\
          & \geq \lambda b + (1-\lambda)b\\
          & \geq b.
        \end{align*}
      \end{proof}
    \end{solution}


  \item On considère  un graphe dirigé donné par un ensemble de noeuds $V$ et d'arcs $E$. L'arc
    $(i, j) \in E$ a une  capacité maximale de
    $h_{ij}$ et est de coût unitaire
    $c_{ij}$. En certains noeuds
    $i \in V$ il y a une quantité
    $b_i$ qui entre  ($b_i >0$) ou qui sort ($b_i <0$). Nous supposons que les quantité entrantes et sortantes s'équilibrent, $\sum_i b_i=0$. Nous
    cherchons un flot admissible de coût minimum.  Formulez ce problème comme un problème d'optimisation linéaire. La solution d'un tel problème est-elle
    toujours unique? Parmi l'ensemble des solutions, on cherche celle(s) qui maximisent le flot en un noeud donn\'e.
    Formulez ce probl\`eme comme un probl\`eme d'optimisation lin\'eaire. Montrez comment  rechercher le   plus court chemin entre deux noeuds dans un
    graphe au moyen de la solution d'un  problème de flot de coût minimum.

    \begin{solution}
      Soit $x_{ij}$ la quantité circulant de $i$ à $j$ avec $(i,j) \in E$.
      Comme le graphe est dirigé, on doit imposer que $x_{ij} \geq 0$.
      \[ \min \sum_{(i,j) \in E} c_{ij}x_{ij} \]
      sous les contraintes
      \begin{align*}
        x_{ij} & \leq h_{ij} & \forall (i,j) \in E\\
        \sum_{(i,j) \in E} x_{ij} - \sum_{(j,i) \in E} x_{ji}
        & = b_{i} & \forall i \in V.
      \end{align*}
      La solution n'est pas toujours unique.
      Pour trouver les solutions optimales qui maximisent
      le flot en un certain noeud $k$, on calcule le coût optimal $z^*$.
      Puis on rajoute une contrainte
      \[ \sum_{(i,j) \in E} c_{ij}x_{ij} = z^* \]
      et on remplace l'objectif par
      \[ \max \sum_{(k,j) \in E} x_{kj} + \sum_{(j,k) \in E} x_{jk}. \]
      Pour calculer le plus court chemin entre deux noeuds d'un graphe,
      si on ne veut pas prendre le coût de l'arc comme la distance entre
      deux noeuds mais avoir la même distance pour chaque arc,
      on peut mettre $c_{ij} = 1$.
      Ensuite, pour calculer le plus court chemin entre
      le noeud $s$ (source) et le noeud $t$ (target),
      on met $b_s = 1$, $b_t = -1$ et les autres $b_i = 0$.
    \end{solution}

\end{enumerate}
